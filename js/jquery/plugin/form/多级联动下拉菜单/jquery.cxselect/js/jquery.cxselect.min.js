/*!
 * cxSelect 1.1
 * date: 2013-02-21
 * https://github.com/ciaoca/cxSelect
 * (c) 2012 Ciaoca, http://ciaoca.com/
 */
(function(e){e.fn.cxSelect=function(t){if(this.length<1)return;t=e.extend({},e.cxSelect.defaults,t);if(!t.selects.length)return;var n=this,r=[],i=t.required?"":"<option value='0'>\u8bf7\u9009\u62e9</option>",s=t.selects.length,o,u,a=function(e){return t.required?e:e-1},f=[],l=function(e){if(!f.length)return;var t=e||0;t<f.length&&setTimeout(function(){r[t].val(r[t].data("val")).trigger("change"),t++,l(t)},1)},c=function(){for(var a=0;a<s;a++)r.push(n.find("select."+t.selects[a]));u=i,e.each(o,function(e,t){typeof t.v=="undefined"||!t.v?u+="<option value='"+t.n+"'>"+t.n+"</option>":u+="<option value='"+t.v+"'>"+t.n+"</option>"}),r[0].html(u);for(var a=0;a<s;a++)r[a].data("val")?f.push(a):r[a].attr("disabled")&&(t.nodata=="none"?r[a].css("display","none"):t.nodata=="hidden"&&r[a].css("visibility","hidden"));n.delegate("select","change",function(){h(this.className)}),l()},h=function(n){var f=[],l,c,h;for(var p=0;p<s;p++){f.push(a(r[p].get(0).selectedIndex));if(l||p>l)r[p].empty().attr("disabled",!0),t.nodata=="none"?r[p].css("display","none"):t.nodata=="hidden"&&r[p].css("visibility","hidden");n.indexOf(t.selects[p])>-1&&(l=p)}c=l+1,h=o;for(var p=0;p<c;p++){if(typeof h[f[p]]=="undefined"||!h[f[p]].s||!h[f[p]].s.length)return;h=h[f[p]].s}u=i,e.each(h,function(e,t){typeof t.v=="undefined"||!t.v?u+="<option value='"+t.n+"'>"+t.n+"</option>":u+="<option value='"+t.v+"'>"+t.n+"</option>"}),r[c]&&r[c].html(u).attr("disabled",!1).css({display:"",visibility:""})};e.getJSON(t.url,function(e){o=e,c()})},e.cxSelect={defaults:{url:"js/city.js",selects:[],nodata:null,required:!1}}})(jQuery);